# 米系亮屏快充模块

暂时适用于小米15 Pro（骁龙8 Elite处理器）的Magisk模块，实现亮屏快充和智能温控管理。

## ✨ 功能特性

- ✅ **亮屏快充**：解除亮屏充电限制，屏幕开启时也能快速充电
- ✅ **智能温控**：充电时临时调整温控限制，拔掉充电器自动恢复
- ✅ **真实电量显示**：从电量计芯片读取真实电量，解决跳电问题
- ✅ **自动校准**：充电时自动校准电量，保持显示准确
- ✅ **灵活配置**：可自定义温度限制，满足不同需求
- ✅ **完全卸载**：卸载时自动恢复所有设置，无残留文件
- ✅ **实时监控**：自动检测充电状态，动态调整参数

## 📦 模块结构

```
xiaomi15pro_fastcharge/
├── module.prop          # 模块信息
├── service.sh           # 后台服务脚本（核心功能）
├── install.sh           # 安装脚本
├── uninstall.sh         # 卸载脚本
├── config.conf          # 配置文件（可自定义）
└── README.md            # 说明文档
```

## 🚀 安装步骤

1. **下载模块**：将所有文件打包为 ZIP 格式
2. **刷入模块**：在 Magisk Manager 中选择 "从本地安装"
3. **重启手机**：模块会在重启后自动生效
4. **验证效果**：插入充电器测试亮屏快充

## ⚙️ 配置说明

编辑 `/data/adb/modules/xiaomi15pro_fastcharge/config.conf` 文件：

```bash
# 充电时的温度限制（单位：摄氏度）
TEMP_LIMIT=45

# 是否启用亮屏快充（1=启用，0=禁用）
SCREEN_ON_CHARGE=1
```

### 温度建议

| 温度设置 | 适用场景 | 风险等级 |
|---------|---------|---------|
| 40-42°C | 日常使用，更安全 | ⭐ 低 |
| 43-45°C | 平衡性能与安全（推荐） | ⭐⭐ 中 |
| 46-50°C | 追求极限充电速度 | ⭐⭐⭐ 高 |

**⚠️ 警告**：温度设置过高可能影响电池寿命！

## 📊 工作原理

1. **启动监控**：系统启动后，模块自动运行后台服务
2. **检测充电**：每5秒检测一次充电状态
3. **应用设置**：
   - 插入充电器：启用亮屏快充 + 临时修改温控
   - 拔出充电器：自动恢复原始温控设置
4. **日志记录**：所有操作记录在日志文件中

## 📝 查看日志

```bash
# 通过 ADB 查看日志
adb shell cat /data/adb/modules/xiaomi15pro_fastcharge/fastcharge.log

# 或在终端模拟器中查看
su
cat /data/adb/modules/xiaomi15pro_fastcharge/fastcharge.log
```

## 🗑️ 卸载模块

### 方法一：Magisk Manager（推荐）
1. 打开 Magisk Manager
2. 找到 "小米15 Pro 亮屏快充模块"
3. 点击卸载
4. 重启手机

### 方法二：手动卸载
```bash
su
sh /data/adb/modules/xiaomi15pro_fastcharge/uninstall.sh
reboot
```

卸载后会：
- ✅ 停止所有后台进程
- ✅ 恢复原始温控配置
- ✅ 删除所有临时文件
- ✅ 清理备份文件
- ✅ 重启温控服务

## ⚠️ 注意事项

1. **仅适用于小米15 Pro**：其他机型未测试，可能无效或有风险
2. **需要Root权限**：必须安装 Magisk 并获取 Root 权限
3. **温度设置需谨慎**：建议不超过 50°C
4. **可能影响保修**：修改系统文件可能影响保修
5. **定期检查电池**：使用后注意观察电池健康度

## 🔧 故障排除

### 问题1：模块安装后无效果
- 检查是否已重启手机
- 确认 Magisk 版本是否支持（建议 v24.0+）
- 查看日志文件排查错误

### 问题2：充电速度没有提升
- 确认使用原装充电器和数据线
- 检查 `config.conf` 中 `SCREEN_ON_CHARGE` 是否为 1
- 查看日志确认模块是否正常运行

### 问题3：手机发热严重
- 降低 `TEMP_LIMIT` 值（如改为 40°C）
- 避免边充电边玩游戏
- 考虑在通风环境下充电

### 问题4：卸载后设置未恢复
- 手动执行：`sh /data/adb/modules/xiaomi15pro_fastcharge/uninstall.sh`
- 重启温控服务：`setprop vendor.sys.thermal.restart 1`
- 恢复出厂设置（最后手段）

## 📄 文件说明

### service.sh（核心服务）
- 后台监控充电状态
- 自动切换温控模式
- 备份和恢复配置

### config.conf（配置文件）
- 用户可修改的参数
- 修改后需重启生效

### uninstall.sh（卸载脚本）
- 完全卸载模块
- 恢复所有原始设置

## 🤝 免责声明

- 本模块仅供学习交流使用
- 使用本模块造成的任何损失，作者不承担责任
- 建议在了解风险后谨慎使用
- 不建议长期使用高温设置

## 📜 更新日志

### v1.0（初始版本）
- ✅ 实现亮屏快充功能
- ✅ 实现智能温控管理
- ✅ 添加可配置参数
- ✅ 完善卸载机制

## 💬 反馈与支持

如有问题或建议，请通过以下方式反馈：
- 查看日志文件进行自我排查
- 在社区论坛发帖求助
- 提供详细的设备信息和日志内容

---

**祝使用愉快！⚡**
